{"ast":null,"code":"\"use strict\";\n/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.PropagationAPI = void 0;\n\nvar getter_1 = require(\"../context/propagation/getter\");\n\nvar NoopHttpTextPropagator_1 = require(\"../context/propagation/NoopHttpTextPropagator\");\n\nvar setter_1 = require(\"../context/propagation/setter\");\n\nvar context_1 = require(\"./context\");\n\nvar global_utils_1 = require(\"./global-utils\");\n\nvar contextApi = context_1.ContextAPI.getInstance();\n/**\n * Singleton object which represents the entry point to the OpenTelemetry Propagation API\n */\n\nvar PropagationAPI =\n/** @class */\nfunction () {\n  /** Empty private constructor prevents end users from constructing a new instance of the API */\n  function PropagationAPI() {}\n  /** Get the singleton instance of the Propagator API */\n\n\n  PropagationAPI.getInstance = function () {\n    if (!this._instance) {\n      this._instance = new PropagationAPI();\n    }\n\n    return this._instance;\n  };\n  /**\n   * Set the current propagator. Returns the initialized propagator\n   */\n\n\n  PropagationAPI.prototype.setGlobalPropagator = function (propagator) {\n    if (global_utils_1._global[global_utils_1.GLOBAL_PROPAGATION_API_KEY]) {\n      // global propagator has already been set\n      return this._getGlobalPropagator();\n    }\n\n    global_utils_1._global[global_utils_1.GLOBAL_PROPAGATION_API_KEY] = global_utils_1.makeGetter(global_utils_1.API_BACKWARDS_COMPATIBILITY_VERSION, propagator, NoopHttpTextPropagator_1.NOOP_HTTP_TEXT_PROPAGATOR);\n    return propagator;\n  };\n  /**\n   * Inject context into a carrier to be propagated inter-process\n   *\n   * @param carrier carrier to inject context into\n   * @param setter Function used to set values on the carrier\n   * @param context Context carrying tracing data to inject. Defaults to the currently active context.\n   */\n\n\n  PropagationAPI.prototype.inject = function (carrier, setter, context) {\n    if (setter === void 0) {\n      setter = setter_1.defaultSetter;\n    }\n\n    if (context === void 0) {\n      context = contextApi.active();\n    }\n\n    return this._getGlobalPropagator().inject(context, carrier, setter);\n  };\n  /**\n   * Extract context from a carrier\n   *\n   * @param carrier Carrier to extract context from\n   * @param getter Function used to extract keys from a carrier\n   * @param context Context which the newly created context will inherit from. Defaults to the currently active context.\n   */\n\n\n  PropagationAPI.prototype.extract = function (carrier, getter, context) {\n    if (getter === void 0) {\n      getter = getter_1.defaultGetter;\n    }\n\n    if (context === void 0) {\n      context = contextApi.active();\n    }\n\n    return this._getGlobalPropagator().extract(context, carrier, getter);\n  };\n  /** Remove the global propagator */\n\n\n  PropagationAPI.prototype.disable = function () {\n    delete global_utils_1._global[global_utils_1.GLOBAL_PROPAGATION_API_KEY];\n  };\n\n  PropagationAPI.prototype._getGlobalPropagator = function () {\n    var _a, _b;\n\n    return (_b = (_a = global_utils_1._global[global_utils_1.GLOBAL_PROPAGATION_API_KEY]) === null || _a === void 0 ? void 0 : _a.call(global_utils_1._global, global_utils_1.API_BACKWARDS_COMPATIBILITY_VERSION)) !== null && _b !== void 0 ? _b : NoopHttpTextPropagator_1.NOOP_HTTP_TEXT_PROPAGATOR;\n  };\n\n  return PropagationAPI;\n}();\n\nexports.PropagationAPI = PropagationAPI;","map":{"version":3,"sources":["../../../src/api/propagation.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\n/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PropagationAPI = void 0;\nvar getter_1 = require(\"../context/propagation/getter\");\nvar NoopHttpTextPropagator_1 = require(\"../context/propagation/NoopHttpTextPropagator\");\nvar setter_1 = require(\"../context/propagation/setter\");\nvar context_1 = require(\"./context\");\nvar global_utils_1 = require(\"./global-utils\");\nvar contextApi = context_1.ContextAPI.getInstance();\n/**\n * Singleton object which represents the entry point to the OpenTelemetry Propagation API\n */\nvar PropagationAPI = /** @class */ (function () {\n    /** Empty private constructor prevents end users from constructing a new instance of the API */\n    function PropagationAPI() {\n    }\n    /** Get the singleton instance of the Propagator API */\n    PropagationAPI.getInstance = function () {\n        if (!this._instance) {\n            this._instance = new PropagationAPI();\n        }\n        return this._instance;\n    };\n    /**\n     * Set the current propagator. Returns the initialized propagator\n     */\n    PropagationAPI.prototype.setGlobalPropagator = function (propagator) {\n        if (global_utils_1._global[global_utils_1.GLOBAL_PROPAGATION_API_KEY]) {\n            // global propagator has already been set\n            return this._getGlobalPropagator();\n        }\n        global_utils_1._global[global_utils_1.GLOBAL_PROPAGATION_API_KEY] = global_utils_1.makeGetter(global_utils_1.API_BACKWARDS_COMPATIBILITY_VERSION, propagator, NoopHttpTextPropagator_1.NOOP_HTTP_TEXT_PROPAGATOR);\n        return propagator;\n    };\n    /**\n     * Inject context into a carrier to be propagated inter-process\n     *\n     * @param carrier carrier to inject context into\n     * @param setter Function used to set values on the carrier\n     * @param context Context carrying tracing data to inject. Defaults to the currently active context.\n     */\n    PropagationAPI.prototype.inject = function (carrier, setter, context) {\n        if (setter === void 0) { setter = setter_1.defaultSetter; }\n        if (context === void 0) { context = contextApi.active(); }\n        return this._getGlobalPropagator().inject(context, carrier, setter);\n    };\n    /**\n     * Extract context from a carrier\n     *\n     * @param carrier Carrier to extract context from\n     * @param getter Function used to extract keys from a carrier\n     * @param context Context which the newly created context will inherit from. Defaults to the currently active context.\n     */\n    PropagationAPI.prototype.extract = function (carrier, getter, context) {\n        if (getter === void 0) { getter = getter_1.defaultGetter; }\n        if (context === void 0) { context = contextApi.active(); }\n        return this._getGlobalPropagator().extract(context, carrier, getter);\n    };\n    /** Remove the global propagator */\n    PropagationAPI.prototype.disable = function () {\n        delete global_utils_1._global[global_utils_1.GLOBAL_PROPAGATION_API_KEY];\n    };\n    PropagationAPI.prototype._getGlobalPropagator = function () {\n        var _a, _b;\n        return ((_b = (_a = global_utils_1._global[global_utils_1.GLOBAL_PROPAGATION_API_KEY]) === null || _a === void 0 ? void 0 : _a.call(global_utils_1._global, global_utils_1.API_BACKWARDS_COMPATIBILITY_VERSION)) !== null && _b !== void 0 ? _b : NoopHttpTextPropagator_1.NOOP_HTTP_TEXT_PROPAGATOR);\n    };\n    return PropagationAPI;\n}());\nexports.PropagationAPI = PropagationAPI;\n//# sourceMappingURL=propagation.js.map"]},"metadata":{},"sourceType":"script"}