{"ast":null,"code":"import { RULE_TYPE } from 'fela-utils';\n/**\n * A Fela enhancer that allows to use `:focus-visible`. Uses `what-input` library and its global\n * selector. Modifies generated selectors:\n * `.a:focus-visible {}` => `html[data-whatinput=\"keyboard\"] a:focus`.\n */\n\nexport var felaFocusVisibleEnhancer = function felaFocusVisibleEnhancer(renderer) {\n  var existingEmitChange = renderer._emitChange.bind(renderer);\n\n  renderer._emitChange = function (change) {\n    if (change.type === RULE_TYPE && change.selector.indexOf(':focus-visible') !== -1) {\n      // Fela uses objects by references, it's safe to override properties\n      change.pseudo = change.pseudo ? change.pseudo.replace(':focus-visible', ':focus') : '';\n      change.selector = \"html[data-whatinput=\\\"keyboard\\\"] \" + change.selector.replace(':focus-visible', ':focus');\n    }\n\n    existingEmitChange(change);\n  };\n\n  return renderer;\n};","map":{"version":3,"sources":["felaFocusVisibleEnhancer.ts"],"names":["felaFocusVisibleEnhancer","existingEmitChange","renderer","change"],"mappings":"AAAA,SAAA,SAAA,QAAA,YAAA;AAGA;;;;;;AAKA,OAAO,IAAMA,wBAAwB,GAAG,SAA3BA,wBAA2B,CAAA,QAAA,EAA4B;AAClE,MAAMC,kBAAkB,GAAGC,QAAQ,CAARA,WAAAA,CAAAA,IAAAA,CAA3B,QAA2BA,CAA3B;;AAEAA,EAAAA,QAAQ,CAARA,WAAAA,GAAuB,UAAA,MAAA,EAAgC;AACrD,QAAIC,MAAM,CAANA,IAAAA,KAAAA,SAAAA,IAA6BA,MAAM,CAANA,QAAAA,CAAAA,OAAAA,CAAAA,gBAAAA,MAA8C,CAA/E,CAAA,EAAmF;AACjF;AACAA,MAAAA,MAAM,CAANA,MAAAA,GAAgBA,MAAM,CAANA,MAAAA,GAAgBA,MAAM,CAANA,MAAAA,CAAAA,OAAAA,CAAAA,gBAAAA,EAAhBA,QAAgBA,CAAhBA,GAAhBA,EAAAA;AACAA,MAAAA,MAAM,CAANA,QAAAA,GAAAA,uCAAqDA,MAAM,CAANA,QAAAA,CAAAA,OAAAA,CAAAA,gBAAAA,EAArDA,QAAqDA,CAArDA;AACD;;AAEDF,IAAAA,kBAAkB,CAAlBA,MAAkB,CAAlBA;AAPFC,GAAAA;;AAUA,SAAA,QAAA;AAbK,CAAA","sourcesContent":["import { RULE_TYPE } from 'fela-utils';\nimport { FelaRenderer, FelaRendererChange } from './types';\n\n/**\n * A Fela enhancer that allows to use `:focus-visible`. Uses `what-input` library and its global\n * selector. Modifies generated selectors:\n * `.a:focus-visible {}` => `html[data-whatinput=\"keyboard\"] a:focus`.\n */\nexport const felaFocusVisibleEnhancer = (renderer: FelaRenderer) => {\n  const existingEmitChange = renderer._emitChange.bind(renderer);\n\n  renderer._emitChange = (change: FelaRendererChange) => {\n    if (change.type === RULE_TYPE && change.selector.indexOf(':focus-visible') !== -1) {\n      // Fela uses objects by references, it's safe to override properties\n      change.pseudo = change.pseudo ? change.pseudo.replace(':focus-visible', ':focus') : '';\n      change.selector = `html[data-whatinput=\"keyboard\"] ${change.selector.replace(':focus-visible', ':focus')}`;\n    }\n\n    existingEmitChange(change);\n  };\n\n  return renderer;\n};\n"]},"metadata":{},"sourceType":"module"}